{% extends "main.html" %}
{% load static %}

{% block title %}Register â€“ RetailShop{% endblock %} Â 

{% block content %}


<div class="row justify-content-center">
    <div class="col-md-5">

        <h2 class="fw-bold mb-4">Create Account</h2> Â 

        {# --- ðŸ›‘ 1. DISPLAY GLOBAL/NON-FIELD ERRORS FIRST (CRITICAL) --- #}
        {# This catches errors like passwords not matching or global policy violations #}
        {% if form.non_field_errors %}
            <div class="alert alert-danger">
                {{ form.non_field_errors }}
            </div>
        {% endif %}

        {% if messages %}
            {% for message in messages %}
                <div class="alert alert-{{ message.tags }}">{{ message }}</div>
            {% endfor %}
        {% endif %}

        <form method="POST" enctype="multipart/form-data"> 
            {% csrf_token %}

            {# --- 2. USERNAME FIELD --- #}
            <div class="mb-3">
                <label for="id_username" class="form-label">Username</label>
                <input name="username" id="id_username" type="text" class="form-control" required 
                       {% if form.username.value %}value="{{ form.username.value }}"{% endif %}>
                
                {# ðŸ›‘ DISPLAY USERNAME ERRORS #}
                {% for error in form.username.errors %}
                    <div class="text-danger small">{{ error }}</div>
                {% endfor %}
            </div>
            
            {# --- 3. EMAIL FIELD --- #}
            <div class="mb-3">
                <label for="id_email" class="form-label">Email Address</label>
                <input name="email" id="id_email" type="email" class="form-control" required 
                       {% if form.email.value %}value="{{ form.email.value }}"{% endif %}>
                
                {# ðŸ›‘ DISPLAY EMAIL ERRORS #}
                {% for error in form.email.errors %}
                    <div class="text-danger small">{{ error }}</div>
                {% endfor %}
            </div>

            {# --- 4. PROFILE IMAGE FIELD --- #}
            <div class="mb-3">
                <label for="id_profile_image" class="form-label">Profile Image (Optional)</label>
                <input name="profile_image" id="id_profile_image" type="file" class="form-control">
                
                {# ðŸ›‘ DISPLAY PROFILE IMAGE ERRORS #}
                {% for error in form.profile_image.errors %}
                    <div class="text-danger small">{{ error }}</div>
                {% endfor %}
            </div>

            {# --- 5. PASSWORD 1 FIELD --- #}
            <div class="mb-3">
                <label for="id_password1" class="form-label">Password</label>
                <input name="password1" id="id_password1" type="password" class="form-control" required>
                
                {# ðŸ›‘ DISPLAY PASSWORD 1 ERRORS #}
                {% for error in form.password1.errors %}
                    <div class="text-danger small">{{ error }}</div>
                {% endfor %}
            </div>
        
            {# --- 6. PASSWORD 2 (CONFIRMATION) FIELD --- #}
            <div class="mb-3">
                <label for="id_password2" class="form-label">Confirm Password</label>
                <input name="password2" id="id_password2" type="password" class="form-control" required>
                
                {# ðŸ›‘ DISPLAY PASSWORD 2 ERRORS #}
                {% for error in form.password2.errors %}
                    <div class="text-danger small">{{ error }}</div>
                {% endfor %}
            </div>

            <button type="submit" class="btn btn-success w-100">Register</button>

            <p class="mt-3 text-center">
                Already have an account? <a href="{% url 'login' %}">Login here</a> Â 
            </p>
        </form>

    </div>
</div>

{% endblock %}